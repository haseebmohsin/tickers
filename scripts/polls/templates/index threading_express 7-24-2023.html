




<!-- ************ -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ticker Extraction</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
	<link rel="stylesheet"
		href=
"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>
<body>
  <style>
    body{
      overflow-x: hidden;
    }
  </style>
<!-- ***********loader style*********************** -->
<style>
.loader {
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #0D6EFD;
  /*border-right: 16px solid green;
  border-bottom: 16px solid red;
  border-left: 16px solid pink;*/
  width: 120px;
  height: 120px;
  -webkit-animation: spin 2s linear infinite;
  animation: spin 2s linear infinite;
}

@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>





<!-- ***********loader style*********************** -->


  
	<style>
		.input-icons i {
			position: absolute;
      margin-top: 1%;
		}
		
		.input-icons {
			width: 100%;
			margin-bottom: 10px;
		}
		
		.icon {
			padding: 10px;
			color: black;
			min-width: 50px;
			text-align: center;
		}
		
		.input-field {
			width: 100%;
			padding: 10px;
			text-align: center;
		}
		
		h2 {
			color: black;
		}
	</style>
<script>
  // Get the date input element
  const dateInput = document.getElementById("myDateInput");

  // Set the placeholder text


  // Remove the placeholder text when a date is selected
  dateInput.addEventListener("change", function () {
    this.removeAttribute("placeholder");
  });
</script>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <!-- Brand/logo aligned to the left -->

           <a class="navbar-brand" href="#">
        <img src="/static/Forbmax_Logo.jpg" alt="" width="30" height="24" class="d-inline-block align-text-top">
       Ticker
      </a>
  
      <!-- Ticker and Logout dropdown aligned to the right -->
      <div class="ml-auto">
        <ul class="navbar-nav">
          <!-- <li class="nav-item">
            <a class="nav-link" href="#">
              <marquee behavior="scroll" direction="left" scrollamount="3">Brand Ticker</marquee>
            </a>
          </li> -->
          <li><a class="btn btn-outline-primary" href="{% url 'logout' %}">Logout</a></li>

          <!-- <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle  " href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="bi bi-person-circle"></i> Logout
            </a>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
              <!-- <li><a class="dropdown-item" href="#">Profile</a></li> -->
              <!-- <li><a class="dropdown-item" href="#">Settings</a></li> -->
              <!-- <li><hr class="dropdown-divider"></li> -->
              <!-- <li><a class="dropdown-item" href="{% url 'logout' %}">Logout</a></li> -->
            <!-- </ul> -->
          <!-- </li>  -->
        </ul>
      </div>
    </div>
  </nav>
    


<!-- MODAL FORM -->
<div id="exampleModal" class="modal fade bd-example-modal-xl" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-xl">
	  <div class="modal-content">
		<!-- Modal content -->
		<div class="modal-header">
		  <h5 class="modal-title" id="exampleModalLabel">Send Ticker</h5>
		  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
		</div>
		<div class="modal-body">
  <div></div>    
 
		<!-- <span style="display: flex;justify-content: space-around;"> <button onclick="copyImageToClipboard()"  class="btn btn-primary">Copy to Clipboard</button><input value="+92" type="tel" id="phone" name="phone" pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}"  style="border: 1px solid rgb(137, 137, 137);width: 30%;height: 35px;padding: 10px;border-radius: 5px;" placeholder="EnterNumberHere"></span> -->

        <span style="display: flex;justify-content: center;"> <button onclick="copyImageToClipboard()"  class="btn btn-primary">Copy to Clipboard</button></span>
<br/>
			<img  width="100%" src="" id="cacheclear">
		  <!-- Modal body content goes here -->
		</div>
		<div class="modal-footer">
		  <!-- <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button> -->
		  <!-- <button onclick="sendWhatspp()" type="button" class="btn btn-primary">Send Whatsapp</button> -->
		</div>
	  </div>
	</div>
  </div>
<!-- MODAL FORM END -->
<div class='container-fluid' style="width: 100%;display: block;">
  <div class='row justify-content-center mt-5 ml-5'>
    <div class='col-12 col-md-8' >
      <!-- <div class='card' style="width: 1200px;"> -->
        <div class='card-body' id='changingwidth' style="width: 1600px;">
          <div class='row mb-3'>
            <div class='col-md-4'>
              <div class='input-group'>
                <div class="input-icons">
                  <i class="fa fa-search icon">
                </i>
                  <input name="wordsearched" form="myForm" style="border-radius: 10px;border: 1px solid black;" class="input-field"
                    type="text"
                    placeholder="Search">
                </div>              
              
              </div>
            </div>
            <div class='col-md-5 '>
              <div class='d-flex justify-content-between'>
                <select id="myDropdown" style="border-radius: 10px;width: 50%;border: 1px solid black;" class='form-select p-2'>
                  <option selected value="option0">Choose Channel</option>
                  <option value="option1">Geo</option>
                  <option value="option2">Ary</option>
                  <option value="option3">Samaa</option>
                  <option value="option4">Express</option>
                  <option value="option5">Dunya</option>
                  <option value="option6">NinetyTwo</option>




                </select>
                <div class='form-check form-switch'>
                  <input value=""  style="border-radius: 10px;border: 1px solid black;" class='form-check-input ' type='checkbox' id='toggleSwitch' />
                  <label class='form-check-label' for='toggleSwitch'>Real Time</label>
                </div>
              </div>
            </div>
          </div>
          
          <form method="POST" action="{% url 'index' %}"  id="myForm">
            {% csrf_token %}
          <div class="row gx-5"  >
            <div class="col-sm-6 col-md-2" style="display: none;">
              
              <input   name="channel_name" style="width: 100%;border-radius: 10px;border: 1px solid black;" id="namechannel" type='text' class='form-control' />

            </div>
            <div class="col-sm-6 col-md-2">
              
              <input  name="gettingdate" style="width: 100%;border-radius: 10px;border: 1px solid black;"  type='date' class='form-control' />

            </div>
            <div class="col-sm-6 col-md-2">
              <input name="gettingdateend" style="width: 100%;border-radius: 10px;border: 1px solid black;" type='date' class='form-control' />

            </div>
            <div class="col-sm-6 col-md-2">
              <input name="gettingtime" style="width: 100%;border-radius: 10px;border: 1px solid black;" type='time' class='form-control' />

            </div>
            <div class="col-sm-6 col-md-2">
              <input name="gettingtimeend" style="width: 100%;border-radius: 10px;border: 1px solid black;" type='time' class='form-control' />
 
            </div>

            <div class="col-sm-6 col-md-4">
              <button class='btn btn-primary' style="border-radius: 10px;" id="applyButton" >Apply</button>
 
            </div>
          </div>
        </form>
       
          <div class='row mt-3'>
            <div class='col-md-12'>
              <!-- <button class='btn btn-primary' onclick="console.log('clicking apply')">Apply</button> -->
            </div>
          </div>
          <!-- *************loaderhtml************ -->
          <!-- *************loaderhtml************ -->


		
 
            <table class='table table-sm table-striped'  id="fulltable"  style="width: 77%;display: none;">
              <thead class='table-light'  id="iwilldisplay">
                <tr >

                  <th scope='col' style="text-align: center;">Channel</th>
                  <th scope='col' style="text-align: center;">News</th>
                  <th scope='col' style="text-align: center;">Date</th>
                  <th scope='col' style="text-align: center;">Time</th>
                  <th scope='col' style="text-align: center;"><button class="btn btn-primary" onclick="returningLiveCollage()" >Add to Story</button></th>
				  <th scope='col' style="text-align: center;">Selected</th>


             </tr>
  </thead>
    <tbody class="table-body firsttable">

                <tr   draggable="true" ondragstart="handleDragStart(event)">

                  <td style="width: 10%;"><img id='onelogo' width="70%" src=""></td>
                  <td ><img id="one" src="" width="100%" height="80vh"  ></td>
                  <td width="15%"> <h3 class="date mt-3" ></h3></td>
                  <td width="15%"> <h3 id="timeone" class="mt-3" style="text-align:center"  ></h3></td>

				  <td width="15%" style="text-align: center;"><input type="checkbox"  class="mt-4" id="checkone" name="checkonename" value=""> </td>
<td></td>
                </tr>
                <tr  draggable="true" ondragstart="handleDragStart(event)">


                  <td style="width: 10%;"><img id='twologo' width="70%" src=""></td>

                  <td ><img id="two" src="" width="100%" height="80vh" ></td>
                  <td width="15%"> <h3 class="date mt-3" ></h3></td>
                  <td width="15%"> <h3 id="timetwo" class="mt-3" style="text-align:center"  ></h3></td>
				  <td width="15%" style="text-align: center;"> <input type="checkbox"  class="mt-4" id="checktwo" name="checktwoname" value=""></td>
				  <td></td>

                  </tr>
                  <tr  draggable="true" ondragstart="handleDragStart(event)">


                  <td style="width: 10%;"><img id='threelogo' width="70%" src=""></td>

                  <td ><img id="three" src="" width="100%" height="80vh" ></td>
                  <td width="15%"> <h3 class="date mt-3" ></h3></td>
                  <td width="15%"> <h3 id="timethree" class="mt-3" style="text-align:center"  ></h3></td>
				  <td width="15%" style="text-align: center;"> <input type="checkbox"  class="mt-4" id="checkthree" name="checkthreename" value=""></td>
				  <td></td>

                </tr>
                <tr  draggable="true" ondragstart="handleDragStart(event)">

                  <td style="width: 10%;"><img id='fourlogo' width="70%" src=""></td>

                  <td ><img id="four" src="" width="100%" height="80vh" ></td>
                  <td width="15%"> <h3 class="date mt-3" ></h3></td>
                  <td width="15%"> <h3 id="timefour" class="mt-3" style="text-align:center"  ></h3></td>
                  <td width="15%" style="text-align: center;"><input type="checkbox"  class="mt-4" id="checkfour" name="checkfourname" value=""></td>
				  <td></td>

                </tr>
                <tr  draggable="true" ondragstart="handleDragStart(event)">

                  <td style="width: 10%;"><img id='fivelogo' width="70%" src=""></td>

                  <td ><img id="five" src="" width="100%" height="80vh" ></td>
                  <td width="15%"> <h3 class="date mt-3" ></h3></td>
                  <td width="15%"> <h3 id="timefive" class="mt-3" style="text-align:center"  ></h3></td>
				  <td width="15%" style="text-align: center;"><input type="checkbox"  class="mt-4" id="checkfive" name="checkfivename" value=""></td>
				  <td></td>

                </tr>
                <tr id="displaysix"  draggable="true" ondragstart="handleDragStart(event)">

                  <td style="width: 10%;"><img id='sixlogo' width="70%" src=""></td>

                  <td ><img id="six" src="" width="100%" height="80vh" ></td>
                  <td width="15%"> <h3 class="date mt-3" ></h3></td>
                  <td width="15%"> <h3 id="timesix" class="mt-3" style="text-align:center"  ></h3></td>
				  <td width="15%" style="text-align: center;"><input type="checkbox"  class="mt-4" id="checksix" name="checksixname" value=""></td>
				  <td></td>

                </tr>
                <tr id="displayseven"  draggable="true" ondragstart="handleDragStart(event)">

                  <td style="width: 10%;"><img id='sevenlogo' width="70%" src=""></td>

                  <td ><img id="seven" src="" width="100%" height="80vh" ></td>
                  <td width="15%"> <h3 class="date mt-3" ></h3></td>
                  <td width="15%"> <h3 id="timeseven" class="mt-3" style="text-align:center"  ></h3></td>
				  <td width="15%" style="text-align: center;"><input type="checkbox"  class="mt-4" id="checkseven" name="checksevenname" value=""></td>
				  <td></td>

                </tr>
                <tr id="displayeight"  draggable="true" ondragstart="handleDragStart(event)">

                  <td style="width: 10%;"><img id='eightlogo' width="70%" src=""></td>

                  <td ><img id="eight" src="" width="100%" height="80vh" ></td>
                  <td width="15%"> <h3 class="date mt-3" ></h3></td>
                  <td width="15%"> <h3 id="timeeight" class="mt-3" style="text-align:center"  ></h3></td>
				  <td width="15%" style="text-align: center;"><input type="checkbox"  class="mt-4" id="checkeight" name="checkeightname" value=""></td>
				  <td></td>

                </tr>
                <tr id="displaynine"  draggable="true" ondragstart="handleDragStart(event)">

                  <td style="width: 10%;"><img id='ninelogo' width="70%" src=""></td>

                  <td ><img id="nine" src="" width="100%" height="80vh" ></td>
                  <td width="15%"> <h3 class="date mt-3" ></h3></td>
                  <td width="15%"> <h3 id="timenine" class="mt-3" style="text-align:center"  ></h3></td>
				  <td width="15%" style="text-align: center;"><input type="checkbox"  class="mt-4" id="checknine" name="checkninename" value=""></td>
				  <td></td>

                </tr>
                <tr id="displayten"  draggable="true" ondragstart="handleDragStart(event)">

                  <td style="width: 10%;"><img id='tenlogo' width="70%" src=""></td>

                  <td ><img id="ten" src="" width="100%" height="80vh" ></td>
                  <td width="15%"> <h3 class="date mt-3" ></h3></td>
                  <td width="15%"> <h3 id="timeten" class="mt-3" style="text-align:center"  ></h3></td>
				  <td width="15%" style="text-align: center;"><input type="checkbox"  class="mt-4" id="checkten" name="checktenname" value=""></td>

				  <td></td>

                </tr>
               
                
              </tbody>
            </table>
         


  <div class="container-fluid" style="position: relative;right: 160px;"> 
<table class="table table-sm table-striped " id="resultdisplay" style="display: none; width: 100%">
  <thead class="table-light">
    <tr>

      <th scope="col" style="text-align: center;">Channel</th>
      <th scope="col" style="text-align: center;">News</th>
      <th scope="col" style="text-align: center;">Date</th>
      <th scope="col" style="text-align: center;">Time</th>

	  {% if channel_name != "option0" %}

	  <th class="displayofftable" scope="col" style="text-align: center;display: '';" ><span onclick="returningOfflineCollage()" class="btn btn-primary">Add to Story</span></th>
	  <th class="displayofftable" scope="col" style="text-align: center;display: '';">Selected</th>
	  {% endif %}
    <th scope="col" style="text-align: center;"><span id="textdisplaybutton" class="btn btn-primary">+</span></th>


    </tr>
  </thead>
  <tbody id="table-body" class="table-body secondtable">
    {% for i in result %}
    <!-- this line is responsible for drag and drop -->
    <tr draggable="true" ondragstart="handleDragStart(event)">
		<!-- <td><input type="checkbox"  class="mt-4" id="checkeleven" name="checkelevenname" value=""></td> -->
		

      <td style="width: 10%;"><img width="90%" height="80px" src="/static/{{i.channel_image}}"></td>
      <td  width="30%"><img src="/static/{{i.ticker_image}}" width="100%" height="80vh"></td>
      <td width="20%"><h3 class="mt-3">{{i.date}}</h3></td>
      <td width="15%"><h3 class="mt-3">{{i.time}}</h3></td>
	  {% if channel_name != "option0" %}
	  <td class="displayofftable" width="15%"  style="text-align: center;display: '';"><input type="checkbox"  class="mt-4" id="checkeleven" name="checkelevenname" value=""></td>
	  <td class="displayofftable" style="display:'';" ></td>

{% endif %}
<!-- <td class="texttodisplay" width="15%" style="display: none;"><h3  class="mt-3" style=" font-family: Jameel Noori Nastaleeq; ">{{i.text_ocr}}</h3></td> -->
<td class="texttodisplay" width="15%" style="display: none;"><input  class="mt-3" style=" font-family: Jameel Noori Nastaleeq;font-size: 1.3rem;" type="text" value="{{i.text_ocr}}"></td>


    </tr>
    {% endfor %}
  </tbody>
</table>
</div> 

              <div id="load-more-container" id="displayoff">
                <button id="load-more-btn" class="btn btn-primary" style="display: none">Load More</button>
            </div>
         
        </div>
      <!-- </div> -->
    </div>
</div>

    

	   
<script type="text/javascript">
	//this is the code to drag and drop table rows accurately
	let dragSrcElement = null;
  
	function handleDragStart(event) {

	  dragSrcElement = this;
	  event.dataTransfer.effectAllowed = "move";
	  event.dataTransfer.setData("text/html", this.outerHTML);
	  event.dataTransfer.setData("text/plain", getIndex(this));
	}
  
	function getIndex(element) {
	  let index = 0;
	  let currentElement = element;
	  while ((currentElement = currentElement.previousElementSibling)) {
		index++;
	  }
	  return index;
	}
  
	function handleDragOver(event) {
	  if (event.preventDefault) {
		event.preventDefault();
	  }
	  event.dataTransfer.dropEffect = "move";
	  return false;
	}
  
	function handleDrop(event) {
	  if (event.stopPropagation) {
		event.stopPropagation();
	  }
	  if (dragSrcElement !== this) {
		const dropPlain = event.dataTransfer.getData("text/plain");
		const dropIndex = parseInt(dropPlain);
		const currentIndex = getIndex(this);
		const targetIndex = dropIndex < currentIndex ? currentIndex + 1 : currentIndex;
		moveRow(dropIndex, targetIndex, this.parentNode);
	  }
	  return false;
	}
  
	function moveRow(sourceIndex, targetIndex, parent) {
	  const draggableRows = Array.from(parent.querySelectorAll(".table-body tr"));
	  const sourceRow = draggableRows[sourceIndex];
	  const targetRow = draggableRows[targetIndex];
	  parent.insertBefore(sourceRow, targetRow);
	  draggableRows.splice(sourceIndex, 1);
	  draggableRows.splice(targetIndex, 0, sourceRow);
	  updateRowIndexes(draggableRows, parent);
	}
  
	function updateRowIndexes(rows, parent) {
	  rows.forEach((row, index) => {
		row.dataset.index = index;
	  });
	}
  
	function addDraggableListeners(elem) {
	  elem.addEventListener("dragstart", handleDragStart, false);
	  elem.addEventListener("dragover", handleDragOver, false);
	  elem.addEventListener("drop", handleDrop, false);
	}
  
	const tableBodies = document.querySelectorAll(".table-body");
	tableBodies.forEach((tableBody) => {
	  const draggableRows = tableBody.querySelectorAll("tr");
	  draggableRows.forEach((row) => addDraggableListeners(row));
	});
  </script>
  



<!-- ***********************************For Second TAble************************************ -->
<!-- *************************************************************************************** -->
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<div  style="  display: none;margin-left: auto;margin-right: auto;" id='loading' class="loader mt-5"></div>
<br/>
<br/>
<br/>
<br/>
<h2 style="display: none;text-align: center;color: red" id="warning">Please! Select Channel and then turn on Real Time</h2>


{% if channel_name %}
<script>
	const nameOfChannel="{{channel_name}}"
	console.log(nameOfChannel)
	if (nameOfChannel==="Geo"){
		var selectedOptionGetting = $("#myDropdown").val('option1');
	}

	else if(nameOfChannel==="Ary"){
		var selectedOptionGetting = $("#myDropdown").val('option2');
	}

	else if(nameOfChannel==="Samaa"){
		var selectedOptionGetting = $("#myDropdown").val('option3');
	}

	else if(nameOfChannel==="Express"){
		var selectedOptionGetting = $("#myDropdown").val('option4');
	}

	
	else if(nameOfChannel==="Dunya"){
		var selectedOptionGetting = $("#myDropdown").val('option5');
	}

		
	else if(nameOfChannel==="NinetyTwo"){
		var selectedOptionGetting = $("#myDropdown").val('option6');
	}
</script>
{% endif %}
<!-- each time template renders through return render it will be executed by when toggle button is clicked stat of elements will be change although if result is true as ajax dont look at whole template only the specified elements -->
{% if result %}
<script>
	

    document.getElementById('fulltable').style.display='none'
  document.getElementById('resultdisplay').style.display='block'
  document.getElementById('load-more-btn').style.display=''
  document.getElementById('load-more-btn').style.position='relative'
  document.getElementById('load-more-btn').style.right='130px'



</script>
{% endif %}







<script>

var dunya=false
var programRunning = false;
var intervalSetDunya
var count=0
var intervalSetAry
var intervalSetSamaa
var intervalSetExpress
var intervalSetGeo
var intervalSetNinetyTwo



     function forOption1(optionSelected,url){
      $.ajax({
      url: url,
      method: 'GET',
     
      dataType: 'json',
      success: function(data) {
                      document.getElementById('loading').style.display='none'

        count+=1
        console.log(`data is sent ${count}`)
            document.getElementById('fulltable').style.display='block'


      var images=data.all_tickers
      var gettingTime=data.timedata
      console.log(gettingTime)
      console.log(images)
      for (let index = 0; index < images.length; index++) {
        // console.log('index',index)
        // console.log('data.date',data.date)
        // console.log('data.ticker',data.all_tickers)
        //  console.log('data.text_ocr',data.text_ocr)
        var Datetable = document.getElementsByClassName("date");
        for (var i = 0; i < Datetable.length; i++) {
  Datetable[i].innerHTML = data.date;
  Datetable[i].textAlign='center'
  

}
// var timeTabel=document.getElementsByClassName('time')
// for (let index = 0; index < timeTabel.length; index++) {
// timeTabel[index].innerHTML = data.time
  
// }

// var all_tabel_elements=document.querySelectorAll('td')
// for (let index = 0; index < all_tabel_elements.length; index++) {
// all_tabel_elements[index].style.border = '2px solid black'
// all_tabel_elements[index].style.borderRadius = '25px'

  
// }

// getting_tr_th=document.querySelectorAll('tr th')
// for (let index = 0; index < getting_tr_th.length; index++) {
// getting_tr_th[index].style.border = '2px solid black'
// all_tabel_elements[index].style.borderRadius = '25px'
 
// }
           
        
    
        if (index===0) {
          one=document.getElementById('one')

          one.src='/static/'+String(images[index])
          oneLogo=document.getElementById('onelogo')
          if(optionSelected==='option1'){

          oneLogo.src='/static/geo.png'
          oneLogo.style.width='90%'
                     oneLogo.style.height='80px'

              }
          else if (optionSelected==='option2'){
                      oneLogo.src='/static/ary.png'
                     oneLogo.style.width='90%'
                     oneLogo.style.height='80px'

          }

           else if (optionSelected==='option3'){
                      oneLogo.src='/static/Samaa_logo.png'
                     oneLogo.style.width='90%'
                     oneLogo.style.height='80px'

          }
             else if (optionSelected==='option4'){
                      oneLogo.src='/static/express.png'
                     oneLogo.style.width='90%'
                     oneLogo.className='mb-3'
                     oneLogo.style.height='80px'

          }
                else if (optionSelected==='option5'){
                      oneLogo.src='/static/mzl-ftpchoha.png'
                     oneLogo.style.width='90%'
                     oneLogo.style.height='80px'


          }
                 else if (optionSelected==='option6'){
                      oneLogo.src='/static/ninety_two.png'
                     oneLogo.style.width='90%'
                     oneLogo.style.height='80px'


          }

        document.getElementById('timeone').innerHTML=gettingTime[index]
        }
        if (index===1) {
          two=document.getElementById('two')

          two.src='/static/'+String(images[index])
          
             twoLogo=document.getElementById('twologo')
     if(optionSelected==='option1'){

          twoLogo.src='/static/geo.png'
          twoLogo.style.width='90%'
                  twoLogo.style.height='80px'
              }
          else if (optionSelected==='option2'){
                      twoLogo.src='/static/ary.png'
                  twoLogo.style.width='90%'
                  twoLogo.style.height='80px'
          }
                else if (optionSelected==='option3'){
                      twoLogo.src='/static/Samaa_logo.png'
                     twoLogo.style.width='90%'
                  twoLogo.style.height='80px'

          }
                else if (optionSelected==='option4'){
                      twoLogo.src='/static/express.png'
                     twoLogo.style.width='90%'
                        twoLogo.className="mb-3"
                        twoLogo.style.height='80px'

          }
                 else if (optionSelected==='option5'){
                      twoLogo.src='/static/mzl-ftpchoha.png'
                     twoLogo.style.width='90%'
                     twoLogo.style.height='80px'

          }
                  else if (optionSelected==='option6'){
                      twoLogo.src='/static/ninety_two.png'
                     twoLogo.style.width='90%'
                     twoLogo.style.height='80px'

          }


        document.getElementById('timetwo').innerHTML=gettingTime[index]
              

        }

        if (index===2) {

          three=document.getElementById('three')

          

          three.src='/static/'+String(images[index])
             threeLogo=document.getElementById('threelogo')

     if(optionSelected==='option1'){

          threeLogo.src='/static/geo.png'
          threeLogo.style.width='90%'
                     threeLogo.style.height='80px'
              }
          else if (optionSelected==='option2'){
                      threeLogo.src='/static/ary.png'
                      threeLogo.style.width='90%'
                      threeLogo.style.height='80px'

          }                
       else if (optionSelected==='option3'){
                      threeLogo.src='/static/Samaa_logo.png'
                     threeLogo.style.width='90%'
                     threeLogo.style.height='80px'
          }

            else if (optionSelected==='option4'){
                      threeLogo.src='/static/express.png'
                     threeLogo.style.width='90%'
                     threeLogo.className='mb-3'
                     threeLogo.style.height='80px'
          }

                 else if (optionSelected==='option5'){
                      threeLogo.src='/static/mzl-ftpchoha.png'
                     threeLogo.style.width='90%'
                     threeLogo.style.height='80px'
          }

                  else if (optionSelected==='option6'){
                      threeLogo.src='/static/ninety_two.png'
                     threeLogo.style.width='90%'
                     threeLogo.style.height='80px'
          }
        document.getElementById('timethree').innerHTML=gettingTime[index]
          
        }

        
        if (index===3) {

four=document.getElementById('four')


four.src='/static/'+String(images[index])
   fourLogo=document.getElementById('fourlogo')

            if(optionSelected==='option1'){

          fourLogo.src='/static/geo.png'
          fourLogo.style.width='90%'
                     fourLogo.style.height='80px'
              }
          else if (optionSelected==='option2'){
                      fourLogo.src='/static/ary.png'
                      fourLogo.style.width='90%'
                      fourLogo.style.height='80px'

          }
            else if (optionSelected==='option3'){
                      fourLogo.src='/static/Samaa_logo.png'
                     fourLogo.style.width='90%'
                     fourLogo.style.height='80px'
          }
   else if (optionSelected==='option4'){
                      fourLogo.src='/static/express.png'
                     fourLogo.style.width='90%'
                     fourLogo.className='mb-3'
                     fourLogo.style.height='80px'

          }


           else if (optionSelected==='option5'){
                      fourLogo.src='/static/mzl-ftpchoha.png'
                     fourLogo.style.width='90%'
                     fourLogo.style.height='80px'
          }

             else if (optionSelected==='option6'){
                      fourLogo.src='/static/ninety_two.png'
                     fourLogo.style.width='90%'
                     fourLogo.style.height='80px'
          }
        document.getElementById('timefour').innerHTML=gettingTime[index]

}

        
if (index===4) {

five=document.getElementById('five')


five.src='/static/'+String(images[index])
   fiveLogo=document.getElementById('fivelogo')

     if(optionSelected==='option1'){

          fiveLogo.src='/static/geo.png'
          fiveLogo.style.width='90%'
                     fiveLogo.style.height='80px'
              }
          else if (optionSelected==='option2'){
                      fiveLogo.src='/static/ary.png'
fiveLogo.style.width='90%'
fiveLogo.style.height='80px'
          }  
                else if (optionSelected==='option3'){
                      fiveLogo.src='/static/Samaa_logo.png'
                     fiveLogo.style.width='90%'
                     fiveLogo.style.height='80px'
          }  

                 else if (optionSelected==='option4'){
                      fiveLogo.src='/static/express.png'
                     fiveLogo.style.width='90%'
                     fiveLogo.className='mb-3'
                     fiveLogo.style.height='80px'

          }   
                         else if (optionSelected==='option5'){
                      fiveLogo.src='/static/mzl-ftpchoha.png'
                     fiveLogo.style.width='90%'
                     fiveLogo.style.height='80px'
          }  
               else if (optionSelected==='option6'){
                      fiveLogo.src='/static/ninety_two.png'
                     fiveLogo.style.width='90%'
                     fiveLogo.style.height='80px'
          }  
        document.getElementById('timefive').innerHTML=gettingTime[index]


}

  console.log('length',data.all_tickers.length)



if (index===5) {

six=document.getElementById('six')


six.src='/static/'+String(images[index])

   sixLogo=document.getElementById('sixlogo')

     if(optionSelected==='option1'){

          sixLogo.src='/static/geo.png'
          sixLogo.style.width='90%'
                     sixLogo.style.height='80px'
              }
          else if (optionSelected==='option2'){
                      sixLogo.src='/static/ary.png'
sixLogo.style.width='90%'
sixLogo.style.height='80px'
          }  
                else if (optionSelected==='option3'){
                      sixLogo.src='/static/Samaa_logo.png'
                     sixLogo.style.width='90%'
                     sixLogo.style.height='80px'
          }    

                   else if (optionSelected==='option4'){
                      sixLogo.src='/static/express.png'
                     sixLogo.style.width='90%'
                     sixLogo.className='mb-3'
                     sixLogo.style.height='80px'
          
          }         

                   else if (optionSelected==='option5'){
                      sixLogo.src='/static/mzl-ftpchoha.png'
                     sixLogo.style.width='90%'
                     sixLogo.style.height='80px'
          }         
          else if (optionSelected==='option6'){
                      sixLogo.src='/static/ninety_two.png'
                     sixLogo.style.width='90%'
                     sixLogo.style.height='80px'
          }        
        document.getElementById('timesix').innerHTML=gettingTime[index]

}


if (index===6) {

seven=document.getElementById('seven')


seven.src='/static/'+String(images[index])
   sevenLogo=document.getElementById('sevenlogo')

     if(optionSelected==='option1'){

         sevenLogo.src='/static/geo.png'
         sevenLogo.style.width='90%'
sevenLogo.style.height='80px'
              }
          else if (optionSelected==='option2'){
                     sevenLogo.src='/static/ary.png'
sevenLogo.style.width='90%'
sevenLogo.style.height='80px'

          }        
                else if (optionSelected==='option3'){
                      sevenLogo.src='/static/Samaa_logo.png'
                     sevenLogo.style.width='90%'
                     sevenLogo.style.height='80px'
          
          } 

                  else if (optionSelected==='option4'){
                      sevenLogo.src='/static/express.png'
                     sevenLogo.style.width='90%'
                     sevenLogo.className='mb-3'
                     sevenLogo.style.height='80px'
          
          }  

                      else if (optionSelected==='option5'){
                      sevenLogo.src='/static/mzl-ftpchoha.png'
                     sevenLogo.style.width='90%'
                     sevenLogo.style.height='80px'
          } 
                          else if (optionSelected==='option6'){
                      sevenLogo.src='/static/ninety_two.png'
                     sevenLogo.style.width='90%'
                     sevenLogo.style.height='80px'
          } 
        document.getElementById('timeseven').innerHTML=gettingTime[index]
      
}


if (index===7) {

eight=document.getElementById('eight')


eight.src='/static/'+String(images[index])
   eightLogo=document.getElementById('eightlogo')

     if(optionSelected==='option1'){

         eightLogo.src='/static/geo.png'
         eightLogo.style.width='90%'
                     eightLogo.style.height='80px'
              }
          else if (optionSelected==='option2'){
                     eightLogo.src='/static/ary.png'
                     eightLogo.style.width='90%'
                     eightLogo.style.height='80px'

          }          
                else if (optionSelected==='option3'){
                      eightLogo.src='/static/Samaa_logo.png'
                     eightLogo.style.width='90%'
                     eightLogo.style.height='80px'

          }
               else if (optionSelected==='option4'){
                      eightLogo.src='/static/express.png'
                     eightLogo.style.width='90%'
                     eightLogo.className='mb-3'
                     eightLogo.style.height='80px'

          
          }
                 else if (optionSelected==='option5'){
                      eightLogo.src='/static/mzl-ftpchoha.png'
                     eightLogo.style.width='90%'
                     eightLogo.style.height='80px'

          
          }
                     else if (optionSelected==='option6'){
                      eightLogo.src='/static/ninety_two.png'
                     eightLogo.style.width='90%'
                     eightLogo.style.height='80px'

          
          }
        document.getElementById('timeeight').innerHTML=gettingTime[index]


}


if (index===8) {

nine=document.getElementById('nine')


nine.src='/static/'+String(images[index])
   nineLogo=document.getElementById('ninelogo')

     if(optionSelected==='option1'){

          nineLogo.src='/static/geo.png'
          nineLogo.style.width='90%'
                    nineLogo.style.height='80px'
              }
          else if (optionSelected==='option2'){
                      nineLogo.src='/static/ary.png'
nineLogo.style.width='90%'
nineLogo.style.height='80px'
          }


                 else if (optionSelected==='option3'){
                     nineLogo.src='/static/Samaa_logo.png'
                    nineLogo.style.width='90%'
                    nineLogo.style.height='80px'
          }

                 else if (optionSelected==='option4'){
                     nineLogo.src='/static/express.png'
                    nineLogo.style.width='90%'
                     nineLogo.className='mb-3'
                     nineLogo.style.height='80px'
          
          }


                 else if (optionSelected==='option5'){
                     nineLogo.src='/static/mzl-ftpchoha.png'
                    nineLogo.style.width='90%'
                    nineLogo.style.height='80px'
          }

           else if (optionSelected==='option6'){
                     nineLogo.src='/static/ninety_two.png'
                    nineLogo.style.width='90%'
                    nineLogo.style.height='80px'
          }
        document.getElementById('timenine').innerHTML=gettingTime[index]
          

}

if (index===9) {

ten=document.getElementById('ten')


ten.src='/static/'+String(images[index])
   tenLogo=document.getElementById('tenlogo')

     if(optionSelected==='option1'){

          tenLogo.src='/static/geo.png'
          tenLogo.style.width='90%'
                    tenLogo.style.height='80px'
              }
          else if (optionSelected==='option2'){
                      tenLogo.src='/static/ary.png'
tenLogo.style.width='90%'
tenLogo.style.height='80px'
          }


                 else if (optionSelected==='option3'){
                     tenLogo.src='/static/Samaa_logo.png'
                    tenLogo.style.width='90%'
                    tenLogo.style.height='80px'
          }

                 else if (optionSelected==='option4'){
                     tenLogo.src='/static/express.png'
                    tenLogo.style.width='90%'
                     tenLogo.className='mb-3'
                     tenLogo.style.height='80px'
          
          }


                 else if (optionSelected==='option5'){
                     tenLogo.src='/static/mzl-ftpchoha.png'
                    tenLogo.style.width='90%'
                    tenLogo.style.height='80px'
          }

           else if (optionSelected==='option6'){
                     tenLogo.src='/static/ninety_two.png'
                    tenLogo.style.width='90%'
                    tenLogo.style.height='80px'
          }
        document.getElementById('timeten').innerHTML=gettingTime[index]
          

}

      }
              console.log(`data is finished ${count}`)


      // console.log('images',images)
      //   // Process the response data
      //   console.log(data);
      },
      error: function(error) {
        // Handle any errors that occurred during the request
        console.error(error);
      }
    });
  }
$(document).ready(function() {



  $("#myForm").submit(function(event) {
    event.preventDefault();

    var selectedOption = $("#myDropdown").val();
    $("#namechannel").val(`${selectedOption}`);
    $(this).unbind("submit").submit();


  })
  // Ajax call always look at elements inside it not whole template once the if result condition in set to true during template rendering it will remain true ajax rendering will not effect it unless changed by return render {'result':False} type expression
  // here although above i have defined if result but during toggleSwitch although if result will remain true but ajax will look at those element and change their state but if had defined if not result as the result will be remaining True so table was not rendering
// so you can override if condition element throught ajax but only in case they exists in previous one you have defind table under if not result which will always be False so you get error
  // Add a click event listener to the "Apply" button


   

  $("#toggleSwitch").click(function() {
    document.getElementById('resultdisplay').style.display='none'
    document.getElementById('load-more-btn').style.display='none'
    document.getElementById('loading').style.display='block'
    programRunning = !programRunning;
    var selectedOption = $("#myDropdown").val();
      clearInterval(intervalSetAry)
      clearInterval(intervalSetDunya)
      clearInterval(intervalSetSamaa)
      clearInterval(intervalSetExpress)
      clearInterval(intervalSetGeo)
      clearInterval(intervalSetNinetyTwo)




    // if (selectedOption==='option1'){
    // }
    // else if (selectedOption==='option2'){
    // }

    /* toggleButton.classList.toggle('on');*/
    if (programRunning) {
      // console.log(selectedOption)
      // forOption1()

      applyOption(selectedOption);

  } else {
      document.getElementById('loading').style.display='none'
                document.getElementById('warning').style.display='none'

clearInterval(intervalSetDunya)
clearInterval(intervalSetAry)
clearInterval(intervalSetSamaa)
clearInterval(intervalSetExpress)

clearInterval(intervalSetGeo)
clearInterval(intervalSetNinetyTwo)
    // the purpose of doing reload is when we click to turn off realtime the function are running in backend fro 2 to 3 iteration even when button is clicked to stop this it is used as reload takes place the old session will be expired and new request will only display data data after clicking button after reload window.location.href is better as i was getting problem when i click apply then and turn off realtime the resultdislay table appears to avoid this update window.location.reload() to window.location.href

window.location.href="{% url 'index' %}"
    // window.location.reload()
       // document.getElementById('loading').style.display='none'

// document.getElementById('fulltable').style.display='none'



    
   
  }
  // if (selectedOption==='option1'){

  //   forOption1(selectedOption,url="{% url 'dunya_ticker' %}")
  // }
  // else if (selectedOption==='option2'){
  //   forOption1(selectedOption,url="{% url 'ary_ticker' %}")

  // }
  //  else if (selectedOption==='option3'){
  //   forOption1(selectedOption,url="{% url 'samaa_ticker' %}")

  // }
  //    else if (selectedOption==='option4'){
  //   forOption1(selectedOption,url="{% url 'express_ticker' %}")

  // }
  //    else if (selectedOption==='option5'){
  //   forOption1(selectedOption,url="{% url 'geo_ticker' %}")

  //   document.getElementById('fulltable').style.width='1050px'

  // }
  //  else if (selectedOption==='option6'){
  //   forOption1(selectedOption,url="{% url 'ninety_two_ticker' %}")


  // }

  
      

    // console.log('clicked')
    // Get the selected option value
    
    // Apply the selected option
  });
});


// Function to apply the selected option
function applyOption(option) {
  // clearInterval(intervalSetDunya);

  // Perform the desired action based on the selected option
  switch (option) {
  
    case "option1":
      // dunya=true

      // Action for Option 1
    // forOption1('option1',url="{% url 'geo_ticker' %}")

    intervalSetDunya=setInterval(forOption1,7000,'option1',url="{% url 'geo_ticker' %}")

      /*document.getElementById('iwilldisplay').style.display='block'*/
   
     
 
      // console.log("Option 1 selected");
      break;
    case "option2":
    forOption1('option2',url="{% url 'ary_ticker' %}")

          intervalSetAry=setInterval(forOption1,7000,'option2',url="{% url 'ary_ticker' %}")
          // forOption1('option2',url="{% url 'ary_ticker' %}")

      // Action for Option 2
      console.log("Option 2 selected");
      break;
    case "option3":
    forOption1('option3',url="{% url 'samaa_ticker' %}")

        intervalSetAry=setInterval(forOption1,7000,'option3',url="{% url 'samaa_ticker' %}")

      // Action for Option 3
      console.log("Option 3 selected");
      break;
    case "option4":
      intervalSetExpress=setInterval(forOption1,4000,'option4',url="{% url 'ticker_express_frame_saver' %}")
      // intervalSetTextExpress=setInterval(expressFrameSaver,7000)

       intervalSetExpress=setInterval(forOption1,8000,'option4',url="{% url 'express_ticker' %}")

       break;
   
    case "option5":
    // forOption1('option5',url="{% url 'geo_ticker' %}")

       intervalSetGeo=setInterval(forOption1,7000,'option5',url="{% url 'dunya_ticker' %}")

       break;
    case "option6":
      // forOption1('option6',url="{% url 'ninety_two_ticker' %}")

       intervalSetNinetyTwo=setInterval(forOption1,7000,'option6',url="{% url 'ninety_two_ticker' %}")

       break;
    default:
        document.getElementById('loading').style.display='none'
                document.getElementById('warning').style.display='block'


      // Default action if no option is selected
      
      console.log("No option selected");
  }
}



var textLoader=false
/* Paginator function*/
$(document).ready(function() {
    var page = 2;  // Starting from the second page
    var loadMoreBtn = $("#load-more-btn");
    var tableBody = $("#table-body");
    var loader = $("#loader");
    var loadMoreContainer = $("#load-more-container");

    loadMoreBtn.click(function() {
     
        loadMoreBtn.prop('disabled', true); // Disable the button to prevent multiple clicks
        loader.show(); // Show the loader

        $.ajax({
            url: "{% url 'table_view' %}",
            data: { page: page },
            dataType: 'html',
            success: function(data) {

              console.log('data',data)
              
                var newRows = $(data).find("#resultdisplay tr:not(:first)"); // Extract the new rows from the response, excluding the header row
                tableBody.append(newRows); // Append the new rows to the table body
           const TurnOff=document.getElementsByClassName('displayofftable')
           const getValue=$("#myDropdown").val()
           console.log('textloader',textLoader)
           if (getValue==='option0'){
           for (let index = 0; index < TurnOff.length; index++) {
            TurnOff[index].style.display='none';
            
           }
          }
        if(textLoader){
                const displaytxt=document.getElementsByClassName('texttodisplay')
                for (let index = 0; index < displaytxt.length; index++) {
        
        displaytxt[index].style.display=""
      }
      }
				// calling invokable function
				invokable();
				//adding drag event to newly appended row when rows are appened it looks at whole table and attach event to table rows
					let dragSrcElement = null;
				
				function handleDragStart(event) {

					dragSrcElement = this;
					event.dataTransfer.effectAllowed = "move";
					event.dataTransfer.setData("text/html", this.outerHTML);
					event.dataTransfer.setData("text/plain", getIndex(this));
				}

				function getIndex(element) {
					let index = 0;
					let currentElement = element;
					while ((currentElement = currentElement.previousElementSibling)) {
					index++;
					}
					return index;
				}

				function handleDragOver(event) {
					if (event.preventDefault) {
					event.preventDefault();
					}
					event.dataTransfer.dropEffect = "move";
					return false;
				}

				function handleDrop(event) {
					if (event.stopPropagation) {
					event.stopPropagation();
					}
					if (dragSrcElement !== this) {
					const dropPlain = event.dataTransfer.getData("text/plain");
					const dropIndex = parseInt(dropPlain);
					const currentIndex = getIndex(this);
					const targetIndex = dropIndex < currentIndex ? currentIndex + 1 : currentIndex;
					moveRow(dropIndex, targetIndex, this.parentNode);
					}
					return false;
				}

				function moveRow(sourceIndex, targetIndex, parent) {
					const draggableRows = Array.from(parent.querySelectorAll(".table-body tr"));
					const sourceRow = draggableRows[sourceIndex];
					const targetRow = draggableRows[targetIndex];
					parent.insertBefore(sourceRow, targetRow);
					draggableRows.splice(sourceIndex, 1);
					draggableRows.splice(targetIndex, 0, sourceRow);
					updateRowIndexes(draggableRows, parent);
				}

				function updateRowIndexes(rows, parent) {
					rows.forEach((row, index) => {
					row.dataset.index = index;
					});
				}

				function addDraggableListeners(elem) {
					elem.addEventListener("dragstart", handleDragStart, false);
					elem.addEventListener("dragover", handleDragOver, false);
					elem.addEventListener("drop", handleDrop, false);
				}

				const tableBodies = document.querySelectorAll(".table-body");
				tableBodies.forEach((tableBody) => {
					const draggableRows = tableBody.querySelectorAll("tr");
					draggableRows.forEach((row) => addDraggableListeners(row));
				});
                page++;


                loadMoreBtn.prop('disabled', false); // Enable the button after new data is loaded
                loader.hide(); // Hide the loader
                if (newRows.length === 0) {
                    // loadMoreContainer.remove(); // Remove the load more button container
                }
            },
            error: function(error) {
                console.error(error);
                loadMoreBtn.prop('disabled', false); // Enable the button in case of error
                loader.hide(); // Hide the loader
            },
            complete: function() {
                // loadMoreContainer.remove(); // Remove the load more button container after the first click
            }
        });
    });
});


</script>

<script type="text/javascript">
// 	const imagesPath=[]
// 	// Function to assign numbers to checkboxes
// 	(function() {
//   const checkboxes = document.querySelectorAll('.firsttable input[type="checkbox"]');
//   const assignedNumbers = [];

//   function assignNumbers() {
//     checkboxes.forEach((checkbox, index) => {
//       const nextSibling = checkbox.parentNode.nextElementSibling;
// 	  const checkboxRow = checkbox.parentNode.parentNode; // Get the row element
// 	  const imgSrcCell = checkboxRow.querySelector('td:nth-child(2)'); // Get the second cell (column) in the row


//       if (checkbox.checked) {
//         if (!assignedNumbers.includes(index)) {
//           assignedNumbers.push(index);
//         }
//         nextSibling.textContent = assignedNumbers.indexOf(index) + 1;
// 		const imgSrc = imgSrcCell.querySelector('img').getAttribute('src');
// 		imagesPath.push(imgSrc)


//       } else {
//         const assignedIndex = assignedNumbers.indexOf(index);
//         if (assignedIndex !== -1) {
//           assignedNumbers.splice(assignedIndex, 1);
//         }
		
//         nextSibling.textContent = '';
//       }
//     });
//   }

//   checkboxes.forEach((checkbox) => {
//     checkbox.addEventListener('click', assignNumbers);
//   });
// })();
const imagesPathLive = [];
const imagesPathOffline = [];
const dateLiveIndexes=[]
var dateLive = [];
const dateOfflineIndexes=[]
var dateOffline = [];
var timeLiveIndexes=[];
const timeLive=[];
var timeOfflineIndexes=[];
const timeOffline=[];
(function() {
  const checkboxes = document.querySelectorAll('.firsttable input[type="checkbox"]');
  const assignedNumbers = [];

  function assignNumbers() {
    checkboxes.forEach((checkbox, index) => {
      const checkboxRow = checkbox.parentNode.parentNode; // Get the row element
      const nextSibling = checkbox.parentNode.nextElementSibling;
      const imgSrcCell = checkboxRow.querySelector('td:nth-child(2)'); // Get the second cell (column) in the row
      const dateCell=checkboxRow.querySelector('td:nth-child(3)');
      const timeCell=checkboxRow.querySelector('td:nth-child(4)');

      console.log('timeCell',timeCell)

	  if(imagesPathLive.length>=11){
		imagesPathLive.splice(0,imagesPathLive.length)
	  }



      if (checkbox.checked) {
        if (!assignedNumbers.includes(index)) {
          assignedNumbers.push(index);
        }

        nextSibling.textContent = assignedNumbers.indexOf(index) + 1;
        const imgSrc = imgSrcCell.querySelector('img')?.getAttribute('src');
        const dateTag=dateCell.querySelector('h3')?.textContent;
        const timeTag=timeCell.querySelector('h3')?.textContent;


        if (imgSrc && !imagesPathLive.includes(imgSrc)) {
          imagesPathLive.push(imgSrc);
        }

        if (dateTag && !dateLiveIndexes.includes(index)) {
          dateLiveIndexes.push(index);
          dateLive.push(dateTag);
        }

        if (timeTag && !timeLiveIndexes.includes(index)) {
          timeLiveIndexes.push(index);
          timeLive.push(timeTag);
        }

        
         
        
		
      } else {
        const assignedIndex = assignedNumbers.indexOf(index);

        if (assignedIndex !== -1) {
          assignedNumbers.splice(assignedIndex, 1);
        }
        nextSibling.textContent = '';
        const imgSrc = imgSrcCell.querySelector('img')?.getAttribute('src');
        const dateTag=dateCell.querySelector('h3')?.textContent;
        const timeTag=timeCell.querySelector('h3')?.textContent;
         
        if (imgSrc && imagesPathLive.includes(imgSrc)) {
          const imgIndex = imagesPathLive.indexOf(imgSrc);
          imagesPathLive.splice(imgIndex, 1);
        }
      const timeTagIndex=timeLiveIndexes.indexOf(index)
      const dateTagIndex=dateLiveIndexes.indexOf(index)

      if(timeTagIndex !== -1){
        timeLiveIndexes.splice(timeTagIndex, 1);
        timeLive.splice(timeTagIndex, 1);
      }
   
      if(dateTagIndex !== -1){
        dateLiveIndexes.splice(dateTagIndex, 1);
        dateLive.splice(dateTagIndex, 1);
      }

      }
    });
	console.log('imagesPathLive',imagesPathLive)
  console.log('dateLive',dateLive)
  console.log('timeLiveIndexes',timeLiveIndexes)
  console.log('timeLive',timeLive)


  }

  checkboxes.forEach((checkbox) => {
    checkbox.addEventListener('click', assignNumbers);
	
  });
})();

// function returningLiveCollage() {
//     console.log('This is images path', imagesPathLive);
// 	var selectedOptionGetting = $("#myDropdown").val();
// 	console.log('selectedOptionGetting', selectedOptionGetting)
//   if (dateLive){
//     var text = dateLive[0];
//     var textDiv = document.createElement('div');
//      textDiv.innerHTML = text;
//      document.body.appendChild(textDiv);
//      html2canvas(textDiv, { width: 100, height: 100 }).then(function(canvas) {
//     // Get the image data as a base64-encoded string
//     var imageData = canvas.toDataURL('image/png');
//     $.ajax({
//         url: "{% url 'getting_live_collage' %}",
//         method: 'POST',
//         headers: {
//             'X-CSRFToken': '{{ csrf_token }}',
//             'Content-Type': 'application/json'
//         },
//         data:JSON.stringify({'channelNameValue': selectedOptionGetting, 'liveCollageList': imagesPathLive,'image':imageData }),
//         success: function(data) {
// 			$('#exampleModal').modal('show');
// 			const timestamp = new Date().getTime();

// // Set the timestamp in the image source
// const imageElement = document.getElementById('cacheclear');
// imageElement.src = `/static/ticker.png?timestamp=${timestamp}`;
//             console.log('Done', data);
//         },
//         error: function(error) {
//             console.error(error);
//         }
//     });
  
//   })
//   document.body.removeChild(textDiv);


//   }
  
// }



function returningLiveCollage() {
    console.log('This is images path', imagesPathLive);
	var selectedOptionGetting = $("#myDropdown").val();
	console.log('selectedOptionGetting', selectedOptionGetting)
  $.ajax({
        url: "{% url 'getting_live_collage' %}",
        method: 'POST',
        headers: {
            'X-CSRFToken': '{{ csrf_token }}',
            'Content-Type': 'application/json'
        },
        data:JSON.stringify({'channelNameValue': selectedOptionGetting, 'liveCollageList': imagesPathLive,'dateLive':dateLive,'timeLive':timeLive }),
        success: function(data) {
			$('#exampleModal').modal('show');
			const timestamp = new Date().getTime();

// Set the timestamp in the image source
const imageElement = document.getElementById('cacheclear');
imageElement.src = `/static/ticker.png?timestamp=${timestamp}`;
            console.log('Done', data);
        },
        error: function(error) {
            console.error(error);
        }
    });
  
}

const invokable = () =>{
	const checkboxes = document.querySelectorAll('.secondtable input[type="checkbox"]');
  const assignedNumbers = [];

  function assignNumbers() {
    checkboxes.forEach((checkbox, index) => {
      const checkboxRow = checkbox.parentNode.parentNode; // Get the row element
      const nextSibling = checkbox.parentNode.nextElementSibling;
      const imgSrcCell = checkboxRow.querySelector('td:nth-child(2)'); // Get the second cell (column) in the row
      const dateCell=checkboxRow.querySelector('td:nth-child(3)');

      const timeCell=checkboxRow.querySelector('td:nth-child(4)');



      if (checkbox.checked) {
        if (!assignedNumbers.includes(index)) {
          assignedNumbers.push(index);
        }
        nextSibling.textContent = assignedNumbers.indexOf(index) + 1;
        const imgSrc = imgSrcCell.querySelector('img')?.getAttribute('src');
        const dateTag=dateCell.querySelector('h3')?.textContent;
        const timeTag=timeCell.querySelector('h3')?.textContent;

        if (imgSrc && !imagesPathOffline.includes(imgSrc)) {
          imagesPathOffline.push(imgSrc);
        }
        if (dateTag && !dateOfflineIndexes.includes(index)) {
          dateOfflineIndexes.push(index);
          dateOffline.push(dateTag);
        }

        if (timeTag && !timeOfflineIndexes.includes(index)) {
          timeOfflineIndexes.push(index);
          timeOffline.push(timeTag);
        }
		
      } else {
        const assignedIndex = assignedNumbers.indexOf(index);
        if (assignedIndex !== -1) {
          assignedNumbers.splice(assignedIndex, 1);
        }
        nextSibling.textContent = '';
        const imgSrc = imgSrcCell.querySelector('img')?.getAttribute('src');
        const dateTag=dateCell.querySelector('h3')?.textContent;
        const timeTag=timeCell.querySelector('h3')?.textContent;


        if (imgSrc && imagesPathOffline.includes(imgSrc)) {
          const imgIndex = imagesPathOffline.indexOf(imgSrc);
          imagesPathOffline.splice(imgIndex, 1);
        }
        const timeTagIndex=timeOfflineIndexes.indexOf(index)
      const dateTagIndex=dateOfflineIndexes.indexOf(index)

      if(timeTagIndex !== -1){
        timeOfflineIndexes.splice(timeTagIndex, 1);
        timeOffline.splice(timeTagIndex, 1);
      }
   
      if(dateTagIndex !== -1){
        dateOfflineIndexes.splice(dateTagIndex, 1);
        dateOffline.splice(dateTagIndex, 1);
      }

      


      }
    });
	console.log('imagesPathOffline',imagesPathOffline)
  }

  checkboxes.forEach((checkbox) => {
    checkbox.addEventListener('click', assignNumbers);
	
  });
}

invokable();



function returningOfflineCollage() {
	var selectedOptionGetting = $("#myDropdown").val();
	console.log('selectedOptionGetting', selectedOptionGetting)
    $.ajax({
        url: "{% url 'getting_offline_collage' %}",
        method: 'POST',
        headers: {
            'X-CSRFToken': '{{ csrf_token }}',
            'Content-Type': 'application/json'
        },
        data:JSON.stringify({'channelNameValue': selectedOptionGetting, 'liveCollageList': imagesPathOffline,'offlineCollageList': imagesPathOffline,'dateOffline':dateOffline,'timeOffline':timeOffline }),
        success: function(data) {
            console.log('Done', data);
			$('#exampleModal').modal('show');
			const timestamp = new Date().getTime();
			console.log('timestamp', timestamp)

// Set the timestamp in the image source
const imageElement = document.getElementById('cacheclear');
imageElement.src = `/static/ticker.png?timestamp=${timestamp}`;

        },
        error: function(error) {
            console.error(error);
        }
    });
}





//*********************************************** Whatsapp AJAX*****************************************************************

// *****************************************************************************************************************************
// function assignNumbersOne() {
//   const checkboxesOne = document.querySelectorAll('.secondtable input[type="checkbox"]');
//   let countOne = 0;

//   checkboxesOne.forEach((checkboxOne) => {
//     const nextSibling = checkboxOne.parentNode.nextElementSibling;
//     if (checkboxOne.checked) {
//       countOne++;
//       nextSibling.textContent = countOne;
//     } else {
//       nextSibling.textContent = '';
//     }
//   });
// }

// const checkboxesOne = document.querySelectorAll('.secondtable input[type="checkbox"]');
// checkboxesOne.forEach((checkboxOne) => {
//   checkboxOne.addEventListener('click', assignNumbersOne);
// });

// function openNewWindow() {
//   // Open a new window
//   const newWindow = window.open('', '_blank', 'width=800,height=600');

//   // Create the image element
//   const image = document.createElement('img');
//   image.src = '/static/ticker.jpg';
//   image.alt = 'Image';

//   // Create the button element
//   const button = document.createElement('button');
//   button.className='btn btn-primary'

//   button.textContent = 'Click Me';
//   button.addEventListener('click', function() {
//     // Handle button click event
//     alert('Button Clicked!');
//   });

//   // Append the image and button to the new window's document body
//   newWindow.document.body.appendChild(image);
//   newWindow.document.body.appendChild(button);
// }

// Call the function when the button is clicked
// document.getElementById('openWindowButton').addEventListener('click', openNewWindow);
// *******************************code to copy the image to clipboard***************************************************
function copyImageToClipboard() {
      const imageElement = document.getElementById('cacheclear');
      const imageUrl = imageElement.src;

      fetch(imageUrl)
        .then(response => response.blob())
        .then(blob => {
          const item = new ClipboardItem({ 'image/png': blob });
          navigator.clipboard.write([item])
            .then(() => {
              console.log('Image copied to clipboard');
            })
            .catch(error => {
              console.error('Error copying image to clipboard:', error);
            });
        })
        .catch(error => {
          console.error('Error fetching image:', error);
        });
    }


    document.getElementById('textdisplaybutton').addEventListener('click',function(){
      textLoader=true
      const displaytxt=document.getElementsByClassName('texttodisplay')
      for (let index = 0; index < displaytxt.length; index++) {
        
        displaytxt[index].style.display=""
      }

    })






function expressFrameSaver() {

$.ajax({
    url: "{% url 'express_ticker' %}",
    method: 'GET',
   
    success: function(data) {
        console.log('Done', data);


// Set the timestamp in the image source

    },
    error: function(error) {
        console.error(error);
    }
});
}

    

  </script>
  

</body>




</html>


 